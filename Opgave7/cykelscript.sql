use Opgave7_Cykelrytter

create table rytter
(
init char(3) not null,
rytternavn varchar(30),
primary key (init),
)

create table vm
(
aarstal int not null,
bynavn varchar(20),
land varchar(20),
primary key (aarstal),
)

create table placering
(
aarstal int,
init char(3),
plac int,
primary key (aarstal, init),
foreign key (init) references rytter(init),
foreign key (aarstal) references vm(aarstal),

)
insert into rytter values ('OR', 'Ole Ritter')
insert into rytter values ('LM', 'Leif Mortensen')
insert into rytter values ('MF', 'Mogens Frey')
insert into rytter values ('GF', 'Gert Frank')
insert into rytter values ('JM', 'Jørgen Marcussen')
insert into rytter values ('KR', 'Kjell Rodian')
insert into rytter values ('PB', 'Per Bausager')
insert into rytter values ('FC', 'Finn Clausen')
insert into rytter values ('NF', 'Niels Fredborg')
insert into rytter values ('FR', 'Freddy Reimar')
insert into rytter values ('KGS', 'Kim G. Svendsen')
insert into rytter values ('JV', 'Jens Veggerby')
insert into rytter values ('SMP', 'Steen Michael Pedersen')
insert into rytter values ('JVP', 'Jørgen V. Pedersen')
insert into rytter values ('KE', 'Kim Eriksen')
insert into rytter values ('MM', 'Mikael Marcussen')
insert into rytter values ('JØ', 'Jan Østergaard')
insert into rytter values ('BB', 'Brian Bistrup')
insert into rytter values ('JS', 'Jesper Skibby')
insert into rytter values ('BR', 'Bjarne Riis')
insert into rytter values ('CMM', 'Claus Michael Møller')
insert into rytter values ('BHS', 'Brian Holm')
insert into rytter values ('RS', 'Rolf Sørensen')
insert into rytter values ('BH', 'Bo Hamburger')
insert into rytter values ('KA', 'Kim Andersen')
insert into rytter values ('PM', 'Peter Meinert')
insert into rytter values ('LMI', 'Lars Michaelsen')
insert into rytter values ('NBL', 'Nicolai Bo Larsen')
insert into rytter values ('FH', 'Frank Høj')
insert into rytter values ('SP', 'Søren Petersen')
insert into rytter values ('MK', 'Mikael Kyneb')
insert into rytter values ('MSJ', 'Mark Strange Jacobsen')
insert into rytter values ('MS', 'Michael Sandstød')
insert into rytter values ('DJ', 'Danny Jonassen')
insert into rytter values ('MB', 'Michael Blaudzun')
insert into rytter values ('SL', 'Søren Lilholt')
insert into rytter values ('JWE', 'Johnny Weltz')
insert into rytter values ('MSO', 'Morten Sonne')
insert into rytter values ('JMA', 'Jimmi Madsen')
insert into rytter values ('TB', 'Thomas Bay')
insert into rytter values ('KW', 'Kenneth Weltz')
insert into rytter values ('JC', 'John Carlsen')
insert into rytter values ('PP', 'Per Pedersen')
insert into rytter values ('JW', 'Jesper Worre')
insert into rytter values ('TJ', 'Thomas Jørgensen')
insert into rytter values ('AP', 'Alex Petersen')
insert into rytter values ('AJ', 'Allan Johansen')
insert into rytter values ('NS', 'Nikki Sørensen')
insert into rytter values ('JP', 'Jakob Piil')
insert into rytter values ('TBR', 'Tayeb Braikia')
insert into rytter values ('BC', 'Bekim Christensen')
insert into rytter values ('MSK', 'Michael Skelde')
insert into rytter values ('MR', 'Michael Rasmussen')
insert into rytter values ('JMR', 'Jakob Moe Rasmussen')
insert into rytter values ('MSN', 'Michael Steen Nielsen')
insert into rytter values ('JBP', 'Jørgen Bo Pedersen')
insert into rytter values ('BN', 'Bjarke Nielsen')
insert into rytter values ('LB', 'Lars Ytting Bach')
insert into rytter values ('RJ', 'Rene Jørgensen')
insert into rytter values ('MBR', 'Matti Breschel')
insert into rytter values ('CAS', 'Chris Anker Sørensen')
insert into rytter values ('AL', 'Anders Lund')
insert into rytter values ('JF', 'Jacob Fuglsang')
insert into rytter values ('MMØ', 'Michael Mørkøv')
insert into rytter values ('AR', 'Alex Rasmussen')
insert into rytter values ('MV', 'Michael Valgren')
insert into rytter values ('CJJ', 'Christopher Juul-Jensen')
insert into rytter values ('RG', 'Rasmus Guldhammer')


insert into vm values(2015,'Richmond','USA')
insert into vm values(2014,'Ponferrada','Spanien')
insert into vm values(2013,'Florence','Italien')
insert into vm values(2012,'Valkenburg','Holland')
insert into vm values(2011,'Rudersdal','Danmark')
insert into vm values(2010,'Melbourne','Australien')
insert into vm values(2009,'Mendrisio','Schweiz')
insert into vm values(2008,'Varese','Italien')
insert into vm values(2007,'Stuttgart','Tyskland')
insert into vm values(2006,'Saltzburg','Østrig')
insert into vm values(2005,'Madrid','Spanien')
insert into vm values(2004,'Verona','Italien')
insert into vm values(2003,'Hamilton','Canada')
insert into vm values(2002,'Zolder','Belgien')
insert into vm values(2001,'Parc de Monsanto','Portugal')
insert into vm values(2000,'Plouay','Frankrig')
insert into vm values(1999,'Verona','Italien')
insert into vm values(1998,'Valkenburg','Holland')
insert into vm values(1997,'San Sebastian','Spanien')
insert into vm values(1996,'Lugano','Schweiz')
insert into vm values(1995,'Duitama','Colombia')
insert into vm values(1994,'Agrigento','Italien')
insert into vm values(1993,'Oslo','Norge')
insert into vm values(1992,'Benidorm','Spanien')
insert into vm values(1991,'Stuttgart','Tyskland')
insert into vm values(1990,'Utsunomiya','Japan')
insert into vm values(1989,'Chambery','Frankrig')
insert into vm values(1988,'Ronse','Belgien')
insert into vm values(1987,'Villach','Østrig')
insert into vm values(1986,'Colorado Springs','USA')
insert into vm values(1985,'Giavera-Montello','Italien')
insert into vm values(1984,'Montjuich','Spanien')
insert into vm values(1983,'Altenrhein','Schweiz')
insert into vm values(1982,'Goodwood','England')
insert into vm values(1981,'Prag','Tjekkoslovakiet')
insert into vm values(1980,'Sallanches','Frankrig')
insert into vm values(1979,'Valkenburg','Holland')
insert into vm values(1978,'Nurburgring','Vesttyskland')
insert into vm values(1977,'San Cristobal','Venezuela')
insert into vm values(1976,'Ostuni','Italien')
insert into vm values(1975,'Yvoir','Belgien')
insert into vm values(1974,'Montreal','Canada')
insert into vm values(1973,'Montjuich','Spanien')
insert into vm values(1972,'Gap','Frankrig')
insert into vm values(1971,'Mendrisio','Schweiz')
insert into vm values(1970,'Leicester','England')
insert into vm values(1969,'Zolder','Belgien')
insert into vm values(1968,'Imola','Italien')
insert into vm values(1967,'Heerlen','Holland')

insert into placering values (2015,'CJJ',NULL)
insert into placering values (2015,'RG',NULL)
insert into placering values (2015,'MMØ',78)
insert into placering values (2015,'MV',67)
insert into placering values (2015,'LB',45)
insert into placering values (2015,'MBR',33)
insert into placering values (2014,'CJJ',71)
insert into placering values (2014,'NS',NULL)
insert into placering values (2014,'MMØ',NULL)
insert into placering values (2014,'MV',20)
insert into placering values (2014,'CAS',31)
insert into placering values (2014,'MBR',4)
insert into placering values (2013,'JF',21)
insert into placering values (2013,'CAS',32)
insert into placering values (2013,'MBR',NULL)
insert into placering values (2012,'JF',NULL)
insert into placering values (2012,'CAS',52)
insert into placering values (2012,'MBR',NULL)
insert into placering values (2011,'JF',26)
insert into placering values (2011,'CAS',129)
insert into placering values (2011,'NS',43)
insert into placering values (2011,'LB',32)
insert into placering values (2011,'AL',57)
insert into placering values (2011,'MMØ',18)
insert into placering values (2010,'MBR',2)
insert into placering values (2010,'CAS',23)
insert into placering values (2010,'AR',NULL)
insert into placering values (2010,'LB',76)
insert into placering values (2010,'AL',24)
insert into placering values (2010,'MMØ',NULL)
insert into placering values (2009,'MBR',7)
insert into placering values (2009,'CAS',13)
insert into placering values (2009,'FH',NULL)
insert into placering values (2009,'LB',NULL)
insert into placering values (2009,'AL',NULL)
insert into placering values (2009,'JF',43)
insert into placering values (2008,'MBR',3)
insert into placering values (2008,'CAS',13)
insert into placering values (2008,'FH',65)
insert into placering values (2008,'LB',NULL)
insert into placering values (2008,'AL',NULL)
insert into placering values (2008,'JF',NULL)
insert into placering values (2007,'MBR',NULL)
insert into placering values (2007,'LB',NULL)
insert into placering values (2007,'CAS',25)
insert into placering values (2006,'NS',12)
insert into placering values (2006,'LB',74)
insert into placering values (2006,'AJ',125)
insert into placering values (2005,'JP',6)
insert into placering values (2005,'LB',39)
insert into placering values (2005,'LMI',NULL)
insert into placering values (2004,'MR',13)
insert into placering values (2004,'MSK',NULL)
insert into placering values (2004,'LB',NULL)
insert into placering values (2004,'FH',85)
insert into placering values (2004,'AJ',NULL)
insert into placering values (2004,'RJ',NULL)
insert into placering values (2004,'NS',39)
insert into placering values (2004,'MB',NULL)
insert into placering values (2003,'BH',6)
insert into placering values (2003,'MSK',78)
insert into placering values (2003,'FH',15)
insert into placering values (2003,'BC',32)
insert into placering values (2002,'LMI',12)
insert into placering values (2002,'MSK',60)
insert into placering values (2002,'LB',125)
insert into placering values (2002,'FH',24)
insert into placering values (2002,'AJ',72)
insert into placering values (2002,'JP',124)
insert into placering values (2002,'NS',144)
insert into placering values (2002,'BC',143)
insert into placering values (2001,'MR',36)
insert into placering values (2001,'JBP',NULL)
insert into placering values (2001,'RS',NULL)
insert into placering values (2001,'MB',NULL)
insert into placering values (2001,'FH',NULL)
insert into placering values (2001,'BN',NULL)
insert into placering values (2001,'MSO',75)
insert into placering values (2001,'MSK',91)
insert into placering values (2000,'BH',22)
insert into placering values (2000,'LMI',NULL)
insert into placering values (2000,'RS',63)
insert into placering values (2000,'JMR',NULL)
insert into placering values (2000,'FH',NULL)
insert into placering values (2000,'TBR',NULL)
insert into placering values (2000,'AJ',NULL)
insert into placering values (2000,'DJ',71)
insert into placering values (2000,'NS',41)
insert into placering values (2000,'MSN',62)
insert into placering values (1999,'BH',NULL)
insert into placering values (1999,'LMI',NULL)
insert into placering values (1999,'MSO',NULL)
insert into placering values (1999,'RS',13)
insert into placering values (1999,'MB',NULL)
insert into placering values (1999,'FH',NULL)
insert into placering values (1999,'MK',NULL)
insert into placering values (1999,'AJ',NULL)
insert into placering values (1999,'DJ',NULL)
insert into placering values (1999,'NS',44)
insert into placering values (1999,'SP',NULL)
insert into placering values (1998,'BH',NULL)
insert into placering values (1998,'LMI',NULL)
insert into placering values (1998,'CMM',40)
insert into placering values (1998,'RS',50)
insert into placering values (1998,'PM',NULL)
insert into placering values (1998,'BHS',NULL)
insert into placering values (1998,'FH',NULL)
insert into placering values (1998,'MK',27)
insert into placering values (1998,'AJ',NULL)
insert into placering values (1998,'DJ',NULL)
insert into placering values (1998,'JS',NULL)
insert into placering values (1998,'NBL',NULL)
insert into placering values (1997,'BH',2)
insert into placering values (1997,'LMI',22)
insert into placering values (1997,'CMM',48)
insert into placering values (1997,'BR',59)
insert into placering values (1997,'SP',79)
insert into placering values (1997,'BHS',82)
insert into placering values (1997,'FH',83)
insert into placering values (1997,'MK',NULL)
insert into placering values (1997,'MS',NULL)
insert into placering values (1997,'DJ',NULL)
insert into placering values (1997,'MSJ',NULL)
insert into placering values (1997,'NBL',NULL)
insert into placering values (1996,'BR',10)
insert into placering values (1996,'CMM',30)
insert into placering values (1996,'PM',33)
insert into placering values (1996,'BH',37)
insert into placering values (1996,'JS',NULL)
insert into placering values (1996,'BHS',NULL)
insert into placering values (1996,'MB',NULL)
insert into placering values (1996,'NBL',NULL)
insert into placering values (1996,'MSO',NULL)
insert into placering values (1996,'MK',NULL)
insert into placering values (1996,'FH',NULL)
insert into placering values (1996,'LMI',NULL)
insert into placering values (1995,'RS',9)
insert into placering values (1995,'MB',NULL)
insert into placering values (1995,'BHS',NULL)
insert into placering values (1995,'CMM',NULL)
insert into placering values (1994,'RS',6)
insert into placering values (1994,'BR',9)
insert into placering values (1994,'BH',47)
insert into placering values (1994,'JWE',NULL)
insert into placering values (1994,'JMA',NULL)
insert into placering values (1994,'PM',NULL)
insert into placering values (1994,'BHS',NULL)
insert into placering values (1994,'JS',NULL)
insert into placering values (1994,'LMI',NULL)
insert into placering values (1993,'BR',9)
insert into placering values (1993,'RS',35) 
insert into placering values (1993,'BH',18)
insert into placering values (1993,'PM',36)
insert into placering values (1993,'TB',61)
insert into placering values (1993,'BHS',NULL)
insert into placering values (1993,'JS',NULL)
insert into placering values (1993,'KW',NULL)
insert into placering values (1992,'TJ',NULL)
insert into placering values (1992,'BHS',NULL)
insert into placering values (1992,'JS',NULL)
insert into placering values (1992,'JW',NULL)
insert into placering values (1992,'BH',NULL)
insert into placering values (1992,'TB',NULL)
insert into placering values (1992,'RS',18)
insert into placering values (1992,'JWE',27)
insert into placering values (1992,'PP',55)
insert into placering values (1992,'BR',59)
insert into placering values (1992,'KA',78)
insert into placering values (1992,'KW',89)
insert into placering values (1991,'PM',NULL)
insert into placering values (1991,'BHS',45)
insert into placering values (1991,'JS',NULL)
insert into placering values (1991,'JW',NULL)
insert into placering values (1991,'BH',15)
insert into placering values (1991,'JC',NULL)
insert into placering values (1991,'RS',NULL)
insert into placering values (1991,'JWE',49)
insert into placering values (1991,'SL',NULL)
insert into placering values (1991,'BR',6)
insert into placering values (1991,'KA',38)
insert into placering values (1991,'KW',NULL)
insert into placering values (1990,'JS',NULL)
insert into placering values (1990,'RS',NULL)
insert into placering values (1990,'JWE',7)
insert into placering values (1990,'AP',35)
insert into placering values (1990,'KA',NULL)
insert into placering values (1990,'KW',NULL)
insert into placering values (1989,'PP',NULL)
insert into placering values (1989,'BHS',NULL)
insert into placering values (1989,'JS',NULL)
insert into placering values (1989,'KE',NULL)
insert into placering values (1989,'JØ',NULL)
insert into placering values (1989,'JC',NULL)
insert into placering values (1989,'RS',9)
insert into placering values (1989,'JWE',38)
insert into placering values (1989,'SL',NULL)
insert into placering values (1989,'BR',NULL)
insert into placering values (1989,'KA',NULL)
insert into placering values (1989,'BB',NULL)
insert into placering values (1988,'PP',NULL)
insert into placering values (1988,'BHS',27)
insert into placering values (1988,'JS',NULL)
insert into placering values (1988,'KE',NULL)
insert into placering values (1988,'JVP',NULL)
insert into placering values (1988,'JW',NULL)
insert into placering values (1988,'RS',17)
insert into placering values (1988,'JWE',34)
insert into placering values (1988,'SL',44)
insert into placering values (1988,'AP',NULL)
insert into placering values (1988,'JM',NULL)
insert into placering values (1988,'JV',76)
insert into placering values (1987,'PP',NULL)
insert into placering values (1987,'BHS',NULL)
insert into placering values (1987,'JS',NULL)
insert into placering values (1987,'SMP',NULL)
insert into placering values (1987,'JVP',NULL)
insert into placering values (1987,'JW',NULL)
insert into placering values (1987,'RS',8)
insert into placering values (1987,'JWE',NULL)
insert into placering values (1987,'SL',NULL)
insert into placering values (1987,'KA',30)
insert into placering values (1987,'JM',39)
insert into placering values (1987,'JV',NULL)
insert into placering values (1986,'JS',44)
insert into placering values (1986,'JVP',NULL)
insert into placering values (1986,'JW',8)
insert into placering values (1986,'RS',27)
insert into placering values (1986,'MM',NULL)
insert into placering values (1986,'KE',NULL)
insert into placering values (1986,'JM',38)
insert into placering values (1986,'JV',NULL)
insert into placering values (1985,'SMP',49)
insert into placering values (1985,'JVP',51)
insert into placering values (1985,'JW',43)
insert into placering values (1985,'KA',14)
insert into placering values (1985,'KE',NULL)
insert into placering values (1985,'JM',23)
insert into placering values (1985,'JV',55)
insert into placering values (1984,'SMP',NULL)
insert into placering values (1984,'PB',NULL)
insert into placering values (1984,'JW',NULL)
insert into placering values (1984,'KA',NULL)
insert into placering values (1984,'JM',NULL)
insert into placering values (1984,'JV',NULL)
insert into placering values (1983,'PB',NULL)
insert into placering values (1983,'JW',12)
insert into placering values (1983,'KA',NULL)
insert into placering values (1983,'JM',34)
insert into placering values (1982,'PB',39)
insert into placering values (1982,'JW',38)
insert into placering values (1982,'KA',15)
insert into placering values (1982,'JM',13)
insert into placering values (1981,'PB',43)
insert into placering values (1981,'FR',NULL)
insert into placering values (1981,'JM',NULL)
insert into placering values (1980,'PB',NULL)
insert into placering values (1980,'KA',NULL)
insert into placering values (1980,'JM',8)
insert into placering values (1979,'PB',35)
insert into placering values (1979,'FR',NULL)
insert into placering values (1979,'JM',39)
insert into placering values (1979,'FC',NULL)
insert into placering values (1978,'PB',NULL)
insert into placering values (1978,'FR',NULL)
insert into placering values (1978,'JM',3)
insert into placering values (1978,'FC',NULL)
insert into placering values (1978,'NF',NULL)
insert into placering values (1978,'GF',NULL)
insert into placering values (1978,'KGS',NULL)
insert into placering values (1977,'PB',NULL)
insert into placering values (1977,'JM',27)
insert into placering values (1977,'KR',NULL)
insert into placering values (1977,'GF',NULL)
insert into placering values (1976,'JM',17)
insert into placering values (1975,'OR',NULL)
insert into placering values (1974,'OR',NULL)
insert into placering values (1973,'MF',NULL)
insert into placering values (1973,'LM',17)
insert into placering values (1973,'OR',13)
insert into placering values (1972,'LM',7)
insert into placering values (1972,'OR',NULL)
insert into placering values (1971,'LM',6)
insert into placering values (1971,'OR',9)
insert into placering values (1970,'MF',NULL)
insert into placering values (1970,'LM',2)
insert into placering values (1970,'OR',40)
insert into placering values (1968,'OR',NULL)
insert into placering values (1967,'OR',43)
go
-- antal deltagere per aar
select aarstal,count(*)
from placering 
group by aarstal 

-- bedste placering
select aarstal,min(plac) 
from placering
group by aarstal
--11.1 -- 
select p.aarstal,bplac,rytternavn
from rytter r ,placering p, 
(select aarstal,min(plac) bplac 
from placering
group by aarstal) as bedst
where r.init = p.init and
bedst.bplac = p.plac and
bedst.aarstal = p.aarstal
--
--11.2
select rytternavn,min(aarstal),max(aarstal)
from rytter r join placering p on r.init = p.init
group by rytternavn
--11.3 og 11.4
select rytternavn,min(aarstal),max(aarstal),count(plac),count(*)-count(plac),min(plac)
from rytter r join placering p on r.init = p.init
group by rytternavn
-- 11.5
select p.aarstal,bplac,rytternavn,antal
from rytter r ,placering p, 
(select aarstal,min(plac) bplac,count(*) as antal
from placering
group by aarstal) as bedst
where r.init = p.init and
bedst.bplac = p.plac and
bedst.aarstal = p.aarstal
-- 11.6
select x.rytternavn,count(*)
from 
(select bplac,rytternavn
from rytter r ,placering p, 
(select aarstal,min(plac) bplac,count(*) as antal
from placering
group by aarstal) as bedst
where r.init = p.init and
bedst.bplac = p.plac and
bedst.aarstal = p.aarstal) as x
group by x.rytternavn